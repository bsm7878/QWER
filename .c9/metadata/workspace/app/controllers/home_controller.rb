{"changed":false,"filter":false,"title":"home_controller.rb","tooltip":"/app/controllers/home_controller.rb","value":"class HomeController < ApplicationController\n  helper_method :champion_uri \n    \n  def index\n\n\n  end\n  \n  \n  def school\n    @@summoner = Summoner.where(:summoner => params[:name].gsub(/\\s+/, \"\").downcase).take\n    show_name = params[:name] #회원가입할때 가는 파라미터\n    ban = Ban.where(:ban_summoner => params[:name].gsub(/\\s+/, \"\").downcase).take #금지된 플레이어 불러오기\n   \n    if ban.nil? #만약 금지된 플레이어 목록에 없으면?\n        unless @@summoner.nil?\n                #대학별 db에 뿌려줄 함수 만들기\n                def school_name(school2)\n                    @name = school2.where(:summoner_id => @@summoner.id).take\n                    @name_all = school2.all.order('total_point DESC') #학교내에서 개인 순위_total point로 정렬\n                    @name_name = @name_all.index(@name_all.find {|x| x.summoner_id == @name.summoner_id}) #프로필 밑에 본인이 몇위인지 가져오는것 +1 할것!\n                    @rank_in_major = school2.where(:major => @name.major).order('total_point DESC') #전공별 개인 순위 불러 오기\n                    @name_name_major = @rank_in_major.index(@rank_in_major.find {|x| x.summoner_id == @name.summoner_id})\n                    @main_image = @name.champion #프로필 챔피언 이미지 가져오기\n                    @win_percent = (@name.win.to_f / (@name.win + @name.loose))*100\n                    @all_count = school2.count #대학교 총 학생 수\n                    @all_major_count = school2.where(:major => @name.major).count # 전공 총 학생 수\n                    @percent_univ = ((@name_name + 1)/@all_count.to_f)*100 #학교 상위 몇퍼\n                    @percent_major = ((@name_name_major + 1)/@all_major_count.to_f)*100 #전공 상위 몇퍼\n                    \n                    #전공별 순위 불러 오기\n                    major_rank_hash = Hash.new \n                    major_rank_count = school2.group(:major) #데이터 있는 전공이름 불러오기\n                    major_rank_count.each do |x|\n                        major_rank_count = school2.group(:major).count[\"#{x.major}\"].to_f #전공 해당 데이터 수\n                        major_rank = school2.group(:major).sum(:total_point)[\"#{x.major}\"]./major_rank_count # 전공 total_point\n                        major_rank_hash[\"#{x.major}\"] = major_rank #해쉬에 담기\n                    end \n                    @major_rank_final = major_rank_hash.sort_by {|k,v| v}.reverse #크기가 큰 순서로 정렬  \n                    \n                    \n                    \n                    \n                end\n                \n                #챔피언 이미지 뿌려주기\n                def champion_uri(image2)\n                    case image2 #@name.champion\n                    when \"1\"\n                        @image = \"/lol_img/Annie.png\" #애니\n                    when \"2\"\n                        @image = \"/lol_img/Olaf.png\" #울라프 \n                    when \"3\"\n                        @image = \"/lol_img/Galio.png\" #갈리오\n                    when \"4\"\n                        @image = \"/lol_img/TwistedFate.png\" #트페\n                    when \"5\"\n                        @image = \"/lol_img/XinZhao.png\" #신짜오\n                    when \"6\"\n                        @image = \"/lol_img/Urgot.png\" #우르곳\n                    when \"7\"\n                        @image = \"/lol_img/Leblanc.png\" #르블랑\n                    when \"8\"\n                        @image = \"/lol_img/Vladimir.png\" #블라디\n                    when \"9\"\n                        @image = \"/lol_img/FiddleSticks.png\" #피들\n                    when \"10\"\n                        @image = \"/lol_img/Kayle.png\" #케일\n                    when \"11\"\n                        @image = \"/lol_img/MasterYi.png\" #마이\n                    when \"12\"\n                        @image = \"/lol_img/Alistar.png\" #알리스타\n                    when \"13\"\n                        @image = \"/lol_img/Ryze.png\" #라이즈\n                    when \"14\"\n                        @image = \"/lol_img/Sion.png\" #사이온\n                    when \"15\"\n                        @image = \"/lol_img/Sivir.png\" #시비르\n                    when \"16\"\n                        @image = \"/lol_img/Soraka.png\" #소라카\n                    when \"17\"\n                        @image = \"/lol_img/Teemo.png\" #티모\n                    when \"18\"\n                        @image = \"/lol_img/Tristana.png\" #트리스타나\n                    when \"19\"\n                        @image = \"/lol_img/Warwick.png\" #워웍\n                    when \"20\"\n                        @image = \"/lol_img/Nunu.png\" #누누\n                    when \"21\"\n                        @image = \"/lol_img/MissFortune.png\" #미포\n                    when \"22\"\n                        @image = \"/lol_img/Ashe.png\" #애쉬\n                    when \"23\"\n                        @image = \"/lol_img/Tryndamere.png\" #트린다미어\n                    when \"24\"\n                        @image = \"/lol_img/Jax.png\" #잭스\n                    when \"25\"\n                        @image = \"/lol_img/Morgana.png\" #모르가나\n                    when \"26\"\n                        @image = \"/lol_img/Zilean.png\" #질리언\n                    when \"27\"\n                        @image = \"/lol_img/Singed.png\" #신지드\n                    when \"28\"\n                        @image = \"/lol_img/Evelynn.png\" #이블린\n                    when \"29\"\n                        @image = \"/lol_img/Twitch.png\" #트위치\n                    when \"30\"\n                        @image = \"/lol_img/Karthus.png\" #카서스\n                    when \"31\"\n                        @image = \"/lol_img/Chogath.png\" #초가스\n                    when \"32\"\n                        @image = \"/lol_img/Amumu.png\" #아무무\n                    when \"33\"\n                        @image = \"/lol_img/Rammus.png\" #람머스\n                    when \"34\"\n                        @image = \"/lol_img/Anivia.png\" #애니비아\n                    when \"35\"\n                        @image = \"/lol_img/Shaco.png\" #샤코\n                    when \"36\"\n                        @image = \"/lol_img/DrMundo.png\" #문도\n                    when \"37\"\n                        @image = \"/lol_img/Sona.png\" #소나\n                    when \"38\"\n                        @image = \"/lol_img/Kassadin.png\" #카사딘\n                    when \"39\"\n                        @image = \"/lol_img/Irelia.png\" #이렐리아\n                    when \"40\"\n                        @image = \"/lol_img/Janna.png\" #잔나\n                    when \"41\"\n                        @image = \"/lol_img/Gangplank.png\" #갱플\n                    when \"42\"\n                        @image = \"/lol_img/Corki.png\" #코르키\n                    when \"43\"\n                        @image = \"/lol_img/Karma.png\" #카르마\n                    when \"44\"\n                        @image = \"/lol_img/Taric.png\" #타릭\n                    when \"45\"\n                        @image = \"/lol_img/Veigar.png\" #베이가\n                    when \"48\"\n                        @image = \"/lol_img/Trundle.png\" #트런들\n                    when \"50\"\n                        @image = \"/lol_img/Swain.png\" #스웨인\n                    when \"51\"\n                        @image = \"/lol_img/Caitlyn.png\" #케이틀린\n                    when \"53\"\n                        @image = \"/lol_img/Blitzcrank.png\" #블츠\n                    when \"54\"\n                        @image = \"/lol_img/Malphite.png\" #말파\n                    when \"55\"\n                        @image = \"/lol_img/Katarina.png\" #카타\n                    when \"56\"\n                        @image = \"/lol_img/Nocturne.png\" #녹턴\n                    when \"57\"\n                        @image = \"/lol_img/Maokai.png\" #마오카이\n                    when \"58\"\n                        @image = \"/lol_img/Renekton.png\" #레넥톤\n                    when \"59\"\n                        @image = \"/lol_img/JarvanIV.png\" #자르반\n                    when \"60\"\n                        @image = \"/lol_img/Elise.png\" #엘리스\n                    when \"61\"\n                        @image = \"/lol_img/Orianna.png\" #오리아나\n                    when \"62\"\n                        @image = \"/lol_img/MonkeyKing.png\" #오공\n                    when \"63\"\n                        @image = \"/lol_img/Brand.png\" #브랜드\n                    when \"64\"\n                        @image = \"/lol_img/LeeSin.png\" #리신\n                    when \"67\"\n                        @image = \"/lol_img/Vayne.png\" #베인\n                    when \"68\"\n                        @image = \"/lol_img/Rumble.png\" #럼블\n                    when \"69\"\n                        @image = \"/lol_img/Cassiopeia.png\" #카시오페아\n                    when \"72\"\n                        @image = \"/lol_img/Skarner.png\" #스카너\n                    when \"74\"\n                        @image = \"/lol_img/Heimerdinger.png\" #딩거\n                    when \"75\"\n                        @image = \"/lol_img/Nasus.png\" #나서스\n                    when \"76\"\n                        @image = \"/lol_img/Nidalee.png\" #니달리\n                    when \"77\"\n                        @image = \"/lol_img/Udyr.png\" #우디르\n                    when \"78\"\n                        @image = \"/lol_img/Poppy.png\" #뽀삐\n                    when \"79\"\n                        @image = \"/lol_img/Gragas.png\" #그라가스\n                    when \"80\"\n                        @image = \"/lol_img/Pantheon.png\" #판테온\n                    when \"81\"\n                        @image = \"/lol_img/Ezreal.png\" #이즈리얼\n                    when \"82\"\n                        @image = \"/lol_img/Mordekaiser.png\" #모데카이저\n                    when \"83\"\n                        @image = \"/lol_img/Yorick.png\" #요릭\n                    when \"84\"\n                        @image = \"/lol_img/Akali.png\" #아칼리\n                    when \"85\"\n                        @image = \"/lol_img/Kennen.png\" #케넨\n                    when \"86\"\n                        @image = \"/lol_img/Garen.png\" #가렌\n                    when \"89\"\n                        @image = \"/lol_img/Leona.png\" #레오나\n                    when \"90\"\n                        @image = \"/lol_img/Malzahar.png\" #말자하\n                    when \"91\"\n                        @image = \"/lol_img/Talon.png\" #탈론\n                    when \"92\"\n                        @image = \"/lol_img/Riven.png\" #리븐\n                    when \"96\"\n                        @image = \"/lol_img/KogMaw.png\" #코그모\n                    when \"98\"\n                        @image = \"/lol_img/Shen.png\" #쉔\n                    when \"99\"\n                         @image = \"/lol_img/Lux.png\" #럭스\n                    when \"101\"\n                        @image = \"/lol_img/Xerath.png\" #제라스\n                    when \"102\"\n                        @image = \"/lol_img/Shyvana.png\" #쉬바나\n                    when \"103\"\n                        @image = \"/lol_img/Ahri.png\" #아리\n                    when \"104\"\n                        @image = \"/lol_img/Graves.png\" #그브\n                    when \"105\"\n                        @image = \"/lol_img/Fizz.png\" #피즈\n                    when \"106\"\n                        @image = \"/lol_img/Volibear.png\" #볼베\n                    when \"107\"\n                        @image = \"/lol_img/Rengar.png\" #렝가\n                    when \"110\"\n                        @image = \"/lol_img/Varus.png\" #바루스\n                    when \"111\"\n                        @image = \"/lol_img/Nautilus.png\" #노틸러스\n                    when \"112\"\n                        @image = \"/lol_img/Viktor.png\" #빅토르\n                    when \"113\"\n                        @image = \"/lol_img/Sejuani.png\" #세주아니\n                    when \"114\"\n                        @image = \"/lol_img/Fiora.png\" #피오라\n                    when \"115\"\n                        @image = \"/lol_img/Ziggs.png\" #직스\n                    when \"117\"\n                        @image = \"/lol_img/Lulu.png\" #룰루\n                    when \"119\"\n                        @image = \"/lol_img/Draven.png\" #드레이븐\n                    when \"120\"\n                        @image = \"/lol_img/Hecarim.png\" #헤카림\n                    when \"121\"\n                        @image = \"/lol_img/Khazix.png\" #카직스\n                    when \"122\"\n                        @image = \"/lol_img/Darius.png\" #다리\n                    when \"126\"\n                        @image = \"/lol_img/Jayce.png\" #제이스\n                    when \"127\"\n                        @image = \"/lol_img/Lissandra.png\" #리산드라\n                    when \"131\"\n                        @image = \"/lol_img/Diana.png\" #다이애나\n                    when \"133\"\n                        @image = \"/lol_img/Quinn.png\" #퀸\n                    when \"134\"\n                        @image = \"/lol_img/Syndra.png\" #신드라\n                    when \"136\"\n                        @image = \"/lol_img/AurelionSol.png\" #아우렐리온\n                    when \"143\"\n                        @image = \"/lol_img/Zyra.png\" #자이라\n                    when \"150\"\n                        @image = \"/lol_img/Gnar.png\" #나르\n                    when \"154\"\n                        @image = \"/lol_img/Zac.png\" #자크\n                    when \"157\"\n                        @image = \"/lol_img/Yasuo.png\" #야스오\n                    when \"161\"\n                        @image = \"/lol_img/Velkoz.png\" #벨코즈\n                    when \"201\"\n                        @image = \"/lol_img/Braum.png\" #브라움\n                    when \"202\"\n                        @image = \"/lol_img/Jhin.png\" #진\n                    when \"203\"\n                        @image = \"/lol_img/Kindred.png\" #킨드레드\n                    when \"222\"\n                        @image = \"/lol_img/Jinx.png\" #징크스\n                    when \"223\"\n                        @image = \"/lol_img/TahmKench.png\" #탐켄치\n                    when \"236\"\n                        @image = \"/lol_img/Lucian.png\" #루시안\n                    when \"238\"\n                        @image = \"/lol_img/Zed.png\" #제드\n                    when \"245\"\n                        @image = \"/lol_img/Ekko.png\" #에코\n                    when \"254\"\n                        @image = \"/lol_img/Vi.png\" #바이\n                    when \"266\"\n                        @image = \"/lol_img/Aatrox.png\" #아트록스\n                    when \"267\"\n                        @image = \"/lol_img/Nami.png\" #나미\n                    when \"268\"\n                        @image = \"/lol_img/Azir.png\" #아지르\n                    when \"421\"\n                        @image = \"/lol_img/RekSai.png\" #렉사이\n                    when \"432\"\n                        @image = \"/lol_img/Bard.png\" #바드\n                    when \"412\"\n                        @image = \"/lol_img/Thresh.png\" #쓰레쉬\n                    when \"420\"\n                        @image = \"/lol_img/Illaoi.png\" #일라오이\n                    when \"429\"\n                        @image = \"/lol_img/Kalista.png\" #칼리스타\n                    when \"163\"\n                        @image = \"/lol_img/Taliyah.png\" #탈리야\n                    else\n                        @image = \"/lol_img/Illaoi.png\" #준비중\n                    end\n                end\n                \n                case @@summoner.university \n                when \"전남대\"\n                    school_name(Jnu)  \n                when \"인하대\"\n                    school_name(Inha) \n                when \"조선대\"\n                    school_name(Chosun)\n                when \"부산대\"\n                    school_name(Busan)    \n                end\n                \n                #전국 대학별 순위\n                university_rank_hash = Hash.new\n                university_rank_hash[\"전남대\"] = [Jnu.all.sum(:total_point)/Jnu.all.count, \"/univ_img/jnu.png\"]\n                university_rank_hash[\"인하대\"] = [Inha.all.sum(:total_point)/Inha.all.count, \"/univ_img/inha_univ.png\"]\n                university_rank_hash[\"조선대\"] = [Chosun.all.sum(:total_point)/Chosun.all.count, \"/univ_img/chosun.png\"]\n                university_rank_hash[\"부산대\"] = [Busan.all.sum(:total_point)/Busan.all.count, \"/univ_img/busan.jpg\"]\n                @university_rank_final = university_rank_hash.sort_by {|k,v| v[0]}.reverse #크기가 큰 순서로 정렬\n        \n        else #사이트에 회원이 등록 안되어있으면!\n            #redirect_to '/home/not_summoner'\n            redirect_to controller: 'home', action: 'not_summoner', name: show_name\n        end #사이트에 회원이 등록 안되어있으면 unless문 종료!\n        \n    else #금지된 플레이어에 등록되어 있을때!\n        redirect_to controller: 'home', action: 'ban_player', name: show_name\n    end\n  end\n  \n  \n  def not_summoner #검색했는데 사이트에 등록이 안되어 있을때\n            @ab = params[:name].gsub(/\\s+/, \"\").downcase \n            @ab2 = params[:name] # erb 파일에 소환사 이름 출력\n            @univ_list = UnivMajor.all # 대학 리스트 불러오기\n\n            #소환사 고유 id 불러오기\n            name = URI.encode(@ab)\n            name_uri = \"https://kr.api.pvp.net/api/lol/kr/v1.4/summoner/by-name/#{name}?api_key=0827b90b-3e3b-44db-aca4-ac10ebce0f1c\"\n            source = name_uri\n            resp = Net::HTTP.get_response(URI.parse(source))\n            data = resp.body\n            result = JSON.parse(data)\n            unless result[\"status\"].present? #등록이 되어있으면!\n            \n                    result2 = result[@ab]['id'] #소환사 id\n                \n                    #소환사 정보 불러오기\n                    information_uri = \"https://kr.api.pvp.net/api/lol/kr/v2.5/league/by-summoner/#{result2}/entry?api_key=0827b90b-3e3b-44db-aca4-ac10ebce0f1c\"\n                    source2 = information_uri\n                    resp2 = Net::HTTP.get_response(URI.parse(source2))\n                    data3 = resp2.body\n                    result3 = JSON.parse(data3)\n                    \n                unless result3[\"status\"].present? #언랭이아니면!\n                \n                    #숙련된 챔피언 불러오기\n                    name_uri = \"https://kr.api.pvp.net/championmastery/location/KR/player/#{result2}/champions?api_key=0827b90b-3e3b-44db-aca4-ac10ebce0f1c\"\n                    source2 = name_uri\n                    resp = Net::HTTP.get_response(URI.parse(source2))\n                    data2 = resp.body\n                    result_champion2 = JSON.parse(data2)\n                    @result_champion = result_champion2[0][\"championId\"] #챔피언 \n                    \n                    #챔피언 이미지 뿌려주기\n           \n                case @result_champion #챔피언\n                when 1\n                    @image = \"/lol_img/Annie.png\" #애니\n                when 2\n                    @image = \"/lol_img/Olaf.png\" #울라프 \n                when 3\n                    @image = \"/lol_img/Galio.png\" #갈리오\n                when 4\n                    @image = \"/lol_img/TwistedFate.png\" #트페\n                when 5\n                    @image = \"/lol_img/XinZhao.png\" #신짜오\n                when 6\n                    @image = \"/lol_img/Urgot.png\" #우르곳\n                when 7\n                    @image = \"/lol_img/Leblanc.png\" #르블랑\n                when 8\n                    @image = \"/lol_img/Vladimir.png\" #블라디\n                when 9\n                    @image = \"/lol_img/FiddleSticks.png\" #피들\n                when 10\n                    @image = \"/lol_img/Kayle.png\" #케일\n                when 11\n                    @image = \"/lol_img/MasterYi.png\" #마이\n                when 12\n                    @image = \"/lol_img/Alistar.png\" #알리스타\n                when 13\n                    @image = \"/lol_img/Ryze.png\" #라이즈\n                when 14\n                    @image = \"/lol_img/Sion.png\" #사이온\n                when 15\n                    @image = \"/lol_img/Sivir.png\" #시비르\n                when 16\n                    @image = \"/lol_img/Soraka.png\" #소라카\n                when 17\n                    @image = \"/lol_img/Teemo.png\" #티모\n                when 18\n                    @image = \"/lol_img/Tristana.png\" #트리스타나\n                when 19\n                    @image = \"/lol_img/Warwick.png\" #워웍\n                when 20\n                    @image = \"/lol_img/Nunu.png\" #누누\n                when 21\n                    @image = \"/lol_img/MissFortune.png\" #미포\n                when 22\n                    @image = \"/lol_img/Ashe.png\" #애쉬\n                when 23\n                    @image = \"/lol_img/Tryndamere.png\" #트린다미어\n                when 24\n                    @image = \"/lol_img/Jax.png\" #잭스\n                when 25\n                    @image = \"/lol_img/Morgana.png\" #모르가나\n                when 26\n                    @image = \"/lol_img/Zilean.png\" #질리언\n                when 27\n                    @image = \"/lol_img/Singed.png\" #신지드\n                when 28\n                    @image = \"/lol_img/Evelynn.png\" #이블린\n                when 29\n                    @image = \"/lol_img/Twitch.png\" #트위치\n                when 30\n                    @image = \"/lol_img/Karthus.png\" #카서스\n                when 31\n                    @image = \"/lol_img/Chogath.png\" #초가스\n                when 32\n                    @image = \"/lol_img/Amumu.png\" #아무무\n                when 33\n                    @image = \"/lol_img/Rammus.png\" #람머스\n                when 34\n                    @image = \"/lol_img/Anivia.png\" #애니비아\n                when 35\n                    @image = \"/lol_img/Shaco.png\" #샤코\n                when 36\n                    @image = \"/lol_img/DrMundo.png\" #문도\n                when 37\n                    @image = \"/lol_img/Sona.png\" #소나\n                when 38\n                    @image = \"/lol_img/Kassadin.png\" #카사딘\n                when 39\n                    @image = \"/lol_img/Irelia.png\" #이렐리아\n                when 40\n                    @image = \"/lol_img/Janna.png\" #잔나\n                when 41\n                    @image = \"/lol_img/Gangplank.png\" #갱플\n                when 42\n                    @image = \"/lol_img/Corki.png\" #코르키\n                when 43\n                    @image = \"/lol_img/Karma.png\" #카르마\n                when 44\n                    @image = \"/lol_img/Taric.png\" #타릭\n                when 45\n                    @image = \"/lol_img/Veigar.png\" #베이가\n                when 48\n                    @image = \"/lol_img/Trundle.png\" #트런들\n                when 50\n                    @image = \"/lol_img/Swain.png\" #스웨인\n                when 51\n                    @image = \"/lol_img/Caitlyn.png\" #케이틀린\n                when 53\n                    @image = \"/lol_img/Blitzcrank.png\" #블츠\n                when 54\n                    @image = \"/lol_img/Malphite.png\" #말파\n                when 55\n                    @image = \"/lol_img/Katarina.png\" #카타\n                when 56\n                    @image = \"/lol_img/Nocturne.png\" #녹턴\n                when 57\n                    @image = \"/lol_img/Maokai.png\" #마오카이\n                when 58\n                    @image = \"/lol_img/Renekton.png\" #레넥톤\n                when 59\n                    @image = \"/lol_img/JarvanIV.png\" #자르반\n                when 60\n                    @image = \"/lol_img/Elise.png\" #엘리스\n                when 61\n                    @image = \"/lol_img/Orianna.png\" #오리아나\n                when 62\n                    @image = \"/lol_img/MonkeyKing.png\" #오공\n                when 63\n                    @image = \"/lol_img/Brand.png\" #브랜드\n                when 64\n                    @image = \"/lol_img/LeeSin.png\" #리신\n                when 67\n                    @image = \"/lol_img/Vayne.png\" #베인\n                when 68\n                    @image = \"/lol_img/Rumble.png\" #럼블\n                when 69\n                    @image = \"/lol_img/Cassiopeia.png\" #카시오페아\n                when 72\n                    @image = \"/lol_img/Skarner.png\" #스카너\n                when 74\n                    @image = \"/lol_img/Heimerdinger.png\" #딩거\n                when 75\n                    @image = \"/lol_img/Nasus.png\" #나서스\n                when 76\n                    @image = \"/lol_img/Nidalee.png\" #니달리\n                when 77\n                    @image = \"/lol_img/Udyr.png\" #우디르\n                when 78\n                    @image = \"/lol_img/Poppy.png\" #뽀삐\n                when 79\n                    @image = \"/lol_img/Gragas.png\" #그라가스\n                when 80\n                    @image = \"/lol_img/Pantheon.png\" #판테온\n                when 81\n                    @image = \"/lol_img/Ezreal.png\" #이즈리얼\n                when 82\n                    @image = \"/lol_img/Mordekaiser.png\" #모데카이저\n                when 83\n                    @image = \"/lol_img/Yorick.png\" #요릭\n                when 84\n                    @image = \"/lol_img/Akali.png\" #아칼리\n                when 85\n                    @image = \"/lol_img/Kennen.png\" #케넨\n                when 86\n                    @image = \"/lol_img/Garen.png\" #가렌\n                when 89\n                    @image = \"/lol_img/Leona.png\" #레오나\n                when 90\n                    @image = \"/lol_img/Malzahar.png\" #말자하\n                when 91\n                    @image = \"/lol_img/Talon.png\" #탈론\n                when 92\n                    @image = \"/lol_img/Riven.png\" #리븐\n                when 96\n                    @image = \"/lol_img/KogMaw.png\" #코그모\n                when 98\n                    @image = \"/lol_img/Shen.png\" #쉔\n                when 99\n                     @image = \"/lol_img/Lux.png\" #럭스\n                when 101\n                    @image = \"/lol_img/Xerath.png\" #제라스\n                when 102\n                    @image = \"/lol_img/Shyvana.png\" #쉬바나\n                when 103\n                    @image = \"/lol_img/Ahri.png\" #아리\n                when 104\n                    @image = \"/lol_img/Graves.png\" #그브\n                when 105\n                    @image = \"/lol_img/Fizz.png\" #피즈\n                when 106\n                    @image = \"/lol_img/Volibear.png\" #볼베\n                when 107\n                    @image = \"/lol_img/Rengar.png\" #렝가\n                when 110\n                    @image = \"/lol_img/Varus.png\" #바루스\n                when 111\n                    @image = \"/lol_img/Nautilus.png\" #노틸러스\n                when 112\n                    @image = \"/lol_img/Viktor.png\" #빅토르\n                when 113\n                    @image = \"/lol_img/Sejuani.png\" #세주아니\n                when 114\n                    @image = \"/lol_img/Fiora.png\" #피오라\n                when 115\n                    @image = \"/lol_img/Ziggs.png\" #직스\n                when 117\n                    @image = \"/lol_img/Lulu.png\" #룰루\n                when 119\n                    @image = \"/lol_img/Draven.png\" #드레이븐\n                when 120\n                    @image = \"/lol_img/Hecarim.png\" #헤카림\n                when 121\n                    @image = \"/lol_img/Khazix.png\" #카직스\n                when 122\n                    @image = \"/lol_img/Darius.png\" #다리\n                when 126\n                    @image = \"/lol_img/Jayce.png\" #제이스\n                when 127\n                    @image = \"/lol_img/Lissandra.png\" #리산드라\n                when 131\n                    @image = \"/lol_img/Diana.png\" #다이애나\n                when 133\n                    @image = \"/lol_img/Quinn.png\" #퀸\n                when 134\n                    @image = \"/lol_img/Syndra.png\" #신드라\n                when 136\n                    @image = \"/lol_img/AurelionSol.png\" #아우렐리온\n                when 143\n                    @image = \"/lol_img/Zyra.png\" #자이라\n                when 150\n                    @image = \"/lol_img/Gnar.png\" #나르\n                when 154\n                    @image = \"/lol_img/Zac.png\" #자크\n                when 157\n                    @image = \"/lol_img/Yasuo.png\" #야스오\n                when 161\n                    @image = \"/lol_img/Velkoz.png\" #벨코즈\n                when 201\n                    @image = \"/lol_img/Braum.png\" #브라움\n                when 202\n                    @image = \"/lol_img/Jhin.png\" #진\n                when 203\n                    @image = \"/lol_img/Kindred.png\" #킨드레드\n                when 222\n                    @image = \"/lol_img/Jinx.png\" #징크스\n                when 223\n                    @image = \"/lol_img/TahmKench.png\" #탐켄치\n                when 236\n                    @image = \"/lol_img/Lucian.png\" #루시안\n                when 238\n                    @image = \"/lol_img/Zed.png\" #제드\n                when 245\n                    @image = \"/lol_img/Ekko.png\" #에코\n                when 254\n                    @image = \"/lol_img/Vi.png\" #바이\n                when 266\n                    @image = \"/lol_img/Aatrox.png\" #아트록스\n                when 267\n                    @image = \"/lol_img/Nami.png\" #나미\n                when 268\n                    @image = \"/lol_img/Azir.png\" #아지르\n                when 421\n                    @image = \"/lol_img/RekSai.png\" #렉사이\n                when 432\n                    @image = \"/lol_img/Bard.png\" #바드\n                when 412\n                    @image = \"/lol_img/Thresh.png\" #쓰레쉬\n                when 420\n                    @image = \"/lol_img/Illaoi.png\" #일라오이\n                when 429\n                    @image = \"/lol_img/Kalista.png\" #칼리스타\n                else\n                    @image = \"/lol_img/.png\" #칼리스타\n                end\n \n        \n                    @tier_info = result3[\"#{result2}\"][0]['tier'] #티어\n                    @division_info = result3[\"#{result2}\"][0]['entries'][0]['division'] #티어_단계\n\n                    \n                else #소환사가 언랭일때\n                    redirect_to '/home/not_show'\n                end #소환사가 언랭일때 unless문 종료\n            else #소환사 id가 lol에 등록이 안되어있을때!\n                redirect_to '/home/not_show'\n            end #소환사 id가 lol에 등록이 안되어있을때 unless문 종료\n\n      \n  end\n  \n  \n  def sign #회원가입\n        sign_name = params[:name]\n        sign_name_down = params[:name].gsub(/\\s+/, \"\").downcase\n        unless Summoner.where(:summoner => sign_name).present?  \n            \n            #소환사 고유 id 불러오기\n            name = URI.encode(sign_name_down)\n            name_uri = \"https://kr.api.pvp.net/api/lol/kr/v1.4/summoner/by-name/#{name}?api_key=0827b90b-3e3b-44db-aca4-ac10ebce0f1c\"\n            source = name_uri\n            resp = Net::HTTP.get_response(URI.parse(source))\n            data = resp.body\n            result = JSON.parse(data)\n\n            \n                    result2 = result[sign_name_down]['id'] #소환사 id\n                \n                    #소환사 정보 불러오기\n                    information_uri = \"https://kr.api.pvp.net/api/lol/kr/v2.5/league/by-summoner/#{result2}/entry?api_key=0827b90b-3e3b-44db-aca4-ac10ebce0f1c\"\n                    source2 = information_uri\n                    resp2 = Net::HTTP.get_response(URI.parse(source2))\n                    data3 = resp2.body\n                    result3 = JSON.parse(data3)\n                    \n            \n                \n                    #숙련된 챔피언 불러오기\n                    name_uri = \"https://kr.api.pvp.net/championmastery/location/KR/player/#{result2}/champions?api_key=0827b90b-3e3b-44db-aca4-ac10ebce0f1c\"\n                    source2 = name_uri\n                    resp = Net::HTTP.get_response(URI.parse(source2))\n                    data2 = resp.body\n                    result_champion2 = JSON.parse(data2)\n                    result_champion = result_champion2[0][\"championId\"]\n                    summoner = Summoner.new\n                    summoner.summoner = sign_name_down #소환사 이름_in summoner\n                    summoner.summoner_number = result2 #소환사 id_in summoner\n                    summoner.university = params[:university_major].split[0] #대학_in summoner\n                    summoner.save\n                    \n                    tier_info = result3[\"#{result2}\"][0]['tier'] #티어\n                    division_info = result3[\"#{result2}\"][0]['entries'][0]['division'] #티어_단계\n                    point_info = result3[\"#{result2}\"][0]['entries'][0]['leaguePoints'] #포인트\n                    win_info = result3[\"#{result2}\"][0]['entries'][0]['wins'] #win\n                    loose_info = result3[\"#{result2}\"][0]['entries'][0]['losses'] #loose\n                    \n                    if tier_info == \"BRONZE\"\n                        tier_point = 100\n                    elsif tier_info == \"SILVER\"\n                        tier_point = 600\n                    elsif tier_info == \"GOLD\"\n                        tier_point = 1100\n                    elsif tier_info == \"PLATINUM\"\n                        tier_point = 1600\n                    elsif tier_info == \"DIAMOND\"\n                        tier_point = 2100\n                    elsif tier_info == \"MASTER\"\n                        tier_point = 2600\n                    elsif tier_info == \"CHALLENGER\"\n                        tier_point = 3100\n                    else\n                        \n                    end\n                      \n                    if division_info == \"I\"\n                        division_point = 400\n                    elsif division_info == \"II\"\n                        division_point = 300\n                    elsif division_info == \"III\"\n                        division_point = 200\n                    elsif division_info == \"IV\"\n                        division_point = 100\n                    elsif division_info == \"V\"\n                        division_point = 0\n                    end\n                    \n                    case params[:university_major].split[0] \n                    when \"전남대\"\n                      id2 = Summoner.where(:summoner_number => result2).take\n                      jnu = Jnu.new\n                      jnu.summoner_id = id2.id\n                      jnu.summoner = sign_name\n                      jnu.tier = tier_info\n                      jnu.division = division_info\n                      jnu.point = point_info\n                      jnu.win = win_info\n                      jnu.loose = loose_info\n                      jnu.total_point = tier_point + division_point + point_info\n                      jnu.summoner_number = result2\n                      jnu.university = params[:university_major].split[0] \n                      jnu.major = params[:university_major].split[1] \n                      jnu.admission = params[:admission]\n                      jnu.sex = params[:sex]\n                      jnu.champion = result_champion \n                      jnu.save \n                      \n                    when \"인하대\"\n                      id2 = Summoner.where(:summoner_number => result2).take\n                      jnu = Inha.new\n                      jnu.summoner_id = id2.id\n                      jnu.summoner = sign_name\n                      jnu.tier = tier_info\n                      jnu.division = division_info\n                      jnu.point = point_info\n                      jnu.win = win_info\n                      jnu.loose = loose_info\n                      jnu.total_point = tier_point + division_point + point_info\n                      jnu.summoner_number = result2\n                      jnu.university = params[:university_major].split[0] \n                      jnu.major = params[:university_major].split[1] \n                      jnu.admission = params[:admission]\n                      jnu.sex = params[:sex]\n                      jnu.champion = result_champion \n                      jnu.save \n                    when \"조선대\"\n                      id2 = Summoner.where(:summoner_number => result2).take\n                      jnu = Chosun.new\n                      jnu.summoner_id = id2.id\n                      jnu.summoner = sign_name\n                      jnu.tier = tier_info\n                      jnu.division = division_info\n                      jnu.point = point_info\n                      jnu.win = win_info\n                      jnu.loose = loose_info\n                      jnu.total_point = tier_point + division_point + point_info\n                      jnu.summoner_number = result2\n                      jnu.university = params[:university_major].split[0] \n                      jnu.major = params[:university_major].split[1] \n                      jnu.admission = params[:admission]\n                      jnu.sex = params[:sex]\n                      jnu.champion = result_champion \n                      jnu.save \n                     \n                     when \"부산대\"\n                      id2 = Summoner.where(:summoner_number => result2).take\n                      jnu = Busan.new\n                      jnu.summoner_id = id2.id\n                      jnu.summoner = sign_name\n                      jnu.tier = tier_info\n                      jnu.division = division_info\n                      jnu.point = point_info\n                      jnu.win = win_info\n                      jnu.loose = loose_info\n                      jnu.total_point = tier_point + division_point + point_info\n                      jnu.summoner_number = result2\n                      jnu.university = params[:university_major].split[0] \n                      jnu.major = params[:university_major].split[1] \n                      jnu.admission = params[:admission]\n                      jnu.sex = params[:sex]\n                      jnu.champion = result_champion \n                      jnu.save\n                      \n                    else\n                      \n                    end\n          \n                redirect_to controller: 'home', action: 'school', name: sign_name\n            else\n                redirect_to '/'\n            end\n    \n  end #sign 컨트롤러 끝\n  \n  \n  def update #최신정보 업데이트\n    \n    @@summoner2 = Summoner.where(:summoner => params[:name].gsub(/\\s+/, \"\").downcase).take\n    \n    def update_method(university_name)\n            #챔피언 정보 가져오기\n            information_uri = \"https://kr.api.pvp.net/api/lol/kr/v2.5/league/by-summoner/#{@@summoner2.summoner_number}/entry?api_key=0827b90b-3e3b-44db-aca4-ac10ebce0f1c\"\n            source = information_uri\n            resp = Net::HTTP.get_response(URI.parse(source))\n            data = resp.body\n            result = JSON.parse(data)\n            tier_info = result[\"#{@@summoner2.summoner_number}\"][0]['tier'] #티어\n            division_info = result[\"#{@@summoner2.summoner_number}\"][0]['entries'][0]['division'] #티어_단계\n            point_info = result[\"#{@@summoner2.summoner_number}\"][0]['entries'][0]['leaguePoints'] #포인트\n            win_info = result[\"#{@@summoner2.summoner_number}\"][0]['entries'][0]['wins'] #win\n            loose_info = result[\"#{@@summoner2.summoner_number}\"][0]['entries'][0]['losses'] #loose\n            \n            if tier_info == \"BRONZE\"\n                tier_point = 100\n            elsif tier_info == \"SILVER\"\n                tier_point = 600\n            elsif tier_info == \"GOLD\"\n                tier_point = 1100\n            elsif tier_info == \"PLATINUM\"\n                tier_point = 1600\n            elsif tier_info == \"DIAMOND\"\n                tier_point = 2100\n            elsif tier_info == \"MASTER\"\n                tier_point = 2600\n            elsif tier_info == \"CHALLENGER\"\n                tier_point = 3100\n            else\n                \n            end\n              \n            if division_info == \"I\"\n                division_point = 400\n            elsif division_info == \"II\"\n                division_point = 300\n            elsif division_info == \"III\"\n                division_point = 200\n            elsif division_info == \"IV\"\n                division_point = 100\n            elsif division_info == \"V\"\n                division_point = 0\n            else\n            \n            end\n            \n            #숙련된 챔피언 가져오기\n            name_uri = \"https://kr.api.pvp.net/championmastery/location/KR/player/#{@@summoner2.summoner_number}/champions?api_key=0827b90b-3e3b-44db-aca4-ac10ebce0f1c\"\n            source2 = name_uri\n            resp = Net::HTTP.get_response(URI.parse(source2))\n            data2 = resp.body\n            result_champion2 = JSON.parse(data2)\n            result_champion = result_champion2[0][\"championId\"]\n        \n        \n          jnu = university_name.where(:summoner_id => @@summoner2.id).take\n          jnu.tier = tier_info\n          jnu.division = division_info\n          jnu.point = point_info\n          jnu.win = win_info\n          jnu.loose = loose_info\n          jnu.total_point = tier_point + division_point + point_info\n          jnu.champion = result_champion\n          jnu.save\n    end\n    \n    \n    case @@summoner2.university \n    when \"전남대\"  \n        update_method(Jnu)\n    when \"인하대\"   \n        update_method(Inha)\n    when \"조선대\"   \n        update_method(Chosun)\n    when \"부산대\"   \n        update_method(Busan)\n    else\n      \n    end\n    \n    redirect_to :back\n  end\n  \n  def not_show # 언랭, 라이엇에 등록 안되어 있을때\n\n  end\n  \n  def ban_player # 금지된 플레이어가 검색 되었을때\n    @name = params[:name]\n  end\n  \n  def email_send\n      flyer = params[:flyer]\n      content = params[:content]\n      Anycall.welcome_email(flyer, content).deliver_now\n      redirect_to :back\n  end\n  \n  \n  \n  def plus # 대학 추가\n\n  end\n  \n  def univadd # 대학 저장\n    add = UnivMajor.new\n    add.univ_name = params[:name]\n    add.save\n    redirect_to :back\n  end\n  \n  def all_summoner # 등록된 유저 보여주기 & 삭제\n    @all_summoner = Summoner.all # 모든 유저 보여주기 => 삭제할때\n    \n    # 전남대 티어 분류\n    @bronze_jnu = Jnu.where(:tier => \"BRONZE\").count\n    @silver_jnu = Jnu.where(:tier => \"SILVER\").count\n    @gold_jnu = Jnu.where(:tier => \"GOLD\").count\n    @platinum_jnu = Jnu.where(:tier => \"PLATINUM\").count\n    @diamond_jnu = Jnu.where(:tier => \"DIAMOND\").count\n    @master_jnu = Jnu.where(:tier => \"MASTER\").count\n    @challenger_jnu = Jnu.where(:tier => \"CHALLENGER\").count#\n    # 전남대 성별 구성도\n    @mail_jnu = Jnu.where(:sex => false).count\n    @femail_jnu = Jnu.where(:sex => true).count\n    \n    # 인하대 티어 분류\n    @bronze_inha = Inha.where(:tier => \"BRONZE\").count\n    @silver_inha = Inha.where(:tier => \"SILVER\").count\n    @gold_inha = Inha.where(:tier => \"GOLD\").count\n    @platinum_inha = Inha.where(:tier => \"PLATINUM\").count\n    @diamond_inha = Inha.where(:tier => \"DIAMOND\").count\n    @master_inha = Inha.where(:tier => \"MASTER\").count\n    @challenger_inha = Inha.where(:tier => \"CHALLENGER\").count#\n    # 인하대 성별 구성도\n    @mail_inha = Inha.where(:sex => false).count\n    @femail_inha = Inha.where(:sex => true).count\n    \n    # 조선대 티어 분류\n    @bronze_chosun = Chosun.where(:tier => \"BRONZE\").count\n    @silver_chosun = Chosun.where(:tier => \"SILVER\").count\n    @gold_chosun = Chosun.where(:tier => \"GOLD\").count\n    @platinum_chosun = Chosun.where(:tier => \"PLATINUM\").count\n    @diamond_chosun = Chosun.where(:tier => \"DIAMOND\").count\n    @master_chosun = Chosun.where(:tier => \"MASTER\").count\n    @challenger_chosun = Chosun.where(:tier => \"CHALLENGER\").count#\n    # 조선대 성별 구성도\n    @mail_chosun = Chosun.where(:sex => false).count\n    @femail_chosun = Chosun.where(:sex => true).count\n    \n    \n    \n    \n  end\n  \n  def summoner_delete # 등록된 유저 삭제 파라미터 \n      Summoner.find(params[:delete_id].to_i).destroy\n      if params[:delete_univ] == \"전남대\"\n          Jnu.where(:summoner_id => params[:delete_id].to_i).take.destroy\n      elsif params[:delete_univ] == \"인하대\"\n          Inha.where(:summoner_id => params[:delete_id].to_i).take.destroy  \n      elsif params[:delete_univ] == \"조선대\"\n          Chosun.where(:summoner_id => params[:delete_id].to_i).take.destroy\n      elsif params[:delete_univ] == \"부산대\"\n          Busan.where(:summoner_id => params[:delete_id].to_i).take.destroy\n      else\n          redirect_to '/'\n      end\n      \n          \n      redirect_to :back     \n  end\n  \n  \n  def ban_save #금지된 플레이어 추가\n  \n      ban = Ban.new    \n      ban.ban_summoner = params[:ban_name].gsub(/\\s+/, \"\").downcase\n      ban.save\n      redirect_to :back\n     \n  end\n  \n  \n  \nend\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":9754.765625,"scrollleft":0,"selection":{"start":{"row":696,"column":62},"end":{"row":696,"column":62},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":608,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1466584454000}